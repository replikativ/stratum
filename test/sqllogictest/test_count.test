# test_count.test
# PostgreSQL-compatible COUNT aggregate function tests

statement ok
CREATE TABLE integers (i INTEGER)

statement ok
INSERT INTO integers VALUES (1), (2), (3), (NULL), (NULL)

# COUNT(*)
query I nosort
SELECT COUNT(*) FROM integers
----
5

# COUNT(col) â€” skips NULLs
query I nosort
SELECT COUNT(i) FROM integers
----
3

# COUNT with WHERE
query I nosort
SELECT COUNT(*) FROM integers WHERE i > 1
----
2

query I nosort
SELECT COUNT(i) FROM integers WHERE i > 1
----
2

# COUNT with GROUP BY (non-NULL keys only)
statement ok
CREATE TABLE groups (g INTEGER, v INTEGER)

statement ok
INSERT INTO groups VALUES (1, 10), (1, 20), (1, NULL), (2, 30), (2, NULL)

query II rowsort
SELECT g, COUNT(*) FROM groups GROUP BY g
----
1	3
2	2

query II rowsort
SELECT g, COUNT(v) FROM groups GROUP BY g
----
1	2
2	1

# COUNT DISTINCT (non-NULL data)
statement ok
CREATE TABLE distinct_t (i INTEGER)

statement ok
INSERT INTO distinct_t VALUES (1), (2), (2), (3), (3), (3)

query I nosort
SELECT COUNT(DISTINCT i) FROM distinct_t
----
3
