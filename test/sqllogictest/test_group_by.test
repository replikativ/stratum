# test_group_by.test
# PostgreSQL-compatible GROUP BY tests

statement ok
CREATE TABLE integers (i INTEGER, j INTEGER)

statement ok
INSERT INTO integers VALUES (1, 1), (1, 2), (2, 3), (2, 4), (3, 5)

# Simple GROUP BY
query IR rowsort
SELECT i, SUM(j) FROM integers GROUP BY i
----
1	3.000000
2	7.000000
3	5.000000

query II rowsort
SELECT i, COUNT(*) FROM integers GROUP BY i
----
1	2
2	2
3	1

query IR rowsort
SELECT i, AVG(j) FROM integers GROUP BY i
----
1	1.500000
2	3.500000
3	5.000000

query II rowsort
SELECT i, MIN(j) FROM integers GROUP BY i
----
1	1
2	3
3	5

query II rowsort
SELECT i, MAX(j) FROM integers GROUP BY i
----
1	2
2	4
3	5

# Multi-column GROUP BY
statement ok
CREATE TABLE multi (a INTEGER, b INTEGER, v INTEGER)

statement ok
INSERT INTO multi VALUES (1, 1, 10), (1, 1, 20), (1, 2, 30), (2, 1, 40), (2, 2, 50)

query IIR rowsort
SELECT a, b, SUM(v) FROM multi GROUP BY a, b
----
1	1	30.000000
1	2	30.000000
2	1	40.000000
2	2	50.000000

# GROUP BY with ORDER BY (on group column)
query IR nosort
SELECT i, SUM(j) FROM integers GROUP BY i ORDER BY i
----
1	3.000000
2	7.000000
3	5.000000

# GROUP BY with ORDER BY DESC
query IR nosort
SELECT i, SUM(j) FROM integers GROUP BY i ORDER BY i DESC
----
3	5.000000
2	7.000000
1	3.000000
