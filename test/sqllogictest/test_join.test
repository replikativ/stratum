# test_join.test
# PostgreSQL-compatible JOIN tests (INNER, LEFT)

statement ok
CREATE TABLE t1 (a INTEGER, b INTEGER)

statement ok
INSERT INTO t1 VALUES (1, 10), (2, 20), (3, 30)

statement ok
CREATE TABLE t2 (x INTEGER, c INTEGER)

statement ok
INSERT INTO t2 VALUES (1, 100), (2, 200), (4, 400)

# INNER JOIN
query III rowsort
SELECT t1.a, t1.b, t2.c FROM t1 INNER JOIN t2 ON t1.a = t2.x
----
1	10	100
2	20	200

# LEFT JOIN
query III rowsort
SELECT t1.a, t1.b, t2.c FROM t1 LEFT JOIN t2 ON t1.a = t2.x
----
1	10	100
2	20	200
3	30	NULL

# JOIN with WHERE
query III rowsort
SELECT t1.a, t1.b, t2.c FROM t1 INNER JOIN t2 ON t1.a = t2.x WHERE t2.c > 100
----
2	20	200

# JOIN with same-name key column
statement ok
CREATE TABLE left_t (a INTEGER, val INTEGER)

statement ok
INSERT INTO left_t VALUES (1, 10), (2, 20), (3, 30)

statement ok
CREATE TABLE right_t (a INTEGER, score INTEGER)

statement ok
INSERT INTO right_t VALUES (1, 100), (2, 200), (4, 400)

query III rowsort
SELECT left_t.a, left_t.val, right_t.score FROM left_t INNER JOIN right_t ON left_t.a = right_t.a
----
1	10	100
2	20	200

# Multiple-row join (1-to-many)
statement ok
CREATE TABLE orders (id INTEGER, customer_id INTEGER, amount INTEGER)

statement ok
INSERT INTO orders VALUES (1, 1, 100), (2, 1, 200), (3, 2, 300), (4, 3, 400)

statement ok
CREATE TABLE customers (cid INTEGER, name VARCHAR)

statement ok
INSERT INTO customers VALUES (1, 'Alice'), (2, 'Bob'), (3, 'Carol')

query ITI rowsort
SELECT orders.id, customers.name, orders.amount FROM orders INNER JOIN customers ON orders.customer_id = customers.cid
----
1	Alice	100
2	Alice	200
3	Bob	300
4	Carol	400
