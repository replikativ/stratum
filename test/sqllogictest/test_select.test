# test_select.test
# Basic SELECT projection tests — inspired by PostgreSQL regression/select.sql
# and SQLite sqllogictest suites.
# Covers: SELECT *, column projection, aliases, literals, expressions,
#         ORDER BY, DISTINCT, LIMIT/OFFSET on projections.

statement ok
CREATE TABLE t1 (a INTEGER, b DOUBLE, c TEXT)

statement ok
INSERT INTO t1 VALUES (1, 10.5, 'alpha'), (2, 20.0, 'beta'), (3, 30.5, 'gamma'), (4, 40.0, 'delta'), (5, 50.5, 'epsilon')

# ============================================================
# SELECT * — all columns
# ============================================================

query IRT nosort
SELECT * FROM t1
----
1	10.500000	alpha
2	20.000000	beta
3	30.500000	gamma
4	40.000000	delta
5	50.500000	epsilon

# ============================================================
# Single column projection
# ============================================================

query I nosort
SELECT a FROM t1
----
1
2
3
4
5

query R nosort
SELECT b FROM t1
----
10.500000
20.000000
30.500000
40.000000
50.500000

query T nosort
SELECT c FROM t1
----
alpha
beta
gamma
delta
epsilon

# ============================================================
# Multi-column projection
# ============================================================

query IT nosort
SELECT a, c FROM t1
----
1	alpha
2	beta
3	gamma
4	delta
5	epsilon

# ============================================================
# Aliased columns
# ============================================================

query I nosort
SELECT a AS x FROM t1
----
1
2
3
4
5

query IR nosort
SELECT a AS id, b AS val FROM t1
----
1	10.500000
2	20.000000
3	30.500000
4	40.000000
5	50.500000

# ============================================================
# Integer literal in SELECT
# ============================================================

query I nosort
SELECT 1 FROM t1
----
1
1
1
1
1

query I nosort
SELECT 1 AS one FROM t1
----
1
1
1
1
1

query II nosort
SELECT 1 AS one, a FROM t1
----
1	1
1	2
1	3
1	4
1	5

# ============================================================
# String literal in SELECT
# ============================================================

query T nosort
SELECT 'hello' AS greeting FROM t1
----
hello
hello
hello
hello
hello

# ============================================================
# Expressions in SELECT
# ============================================================

query R nosort
SELECT b + 1 AS bp1 FROM t1
----
11.500000
21.000000
31.500000
41.000000
51.500000

query R nosort
SELECT a * b AS product FROM t1
----
10.500000
40.000000
91.500000
160.000000
252.500000

# ============================================================
# Projection + WHERE filter
# ============================================================

query IR nosort
SELECT a, b FROM t1 WHERE a > 3
----
4	40.000000
5	50.500000

query T nosort
SELECT c FROM t1 WHERE b >= 30.5
----
gamma
delta
epsilon

# ============================================================
# ORDER BY on projection
# ============================================================

query I nosort
SELECT a FROM t1 ORDER BY a ASC
----
1
2
3
4
5

query I nosort
SELECT a FROM t1 ORDER BY a DESC
----
5
4
3
2
1

query R nosort
SELECT b FROM t1 ORDER BY b DESC
----
50.500000
40.000000
30.500000
20.000000
10.500000

# ============================================================
# DISTINCT on projection
# ============================================================

statement ok
CREATE TABLE t2 (x INTEGER, y TEXT)

statement ok
INSERT INTO t2 VALUES (1, 'a'), (2, 'b'), (1, 'a'), (3, 'c'), (2, 'b')

query I rowsort
SELECT DISTINCT x FROM t2
----
1
2
3

query IT rowsort
SELECT DISTINCT x, y FROM t2
----
1	a
2	b
3	c

# ============================================================
# LIMIT and OFFSET
# ============================================================

query I nosort
SELECT a FROM t1 ORDER BY a LIMIT 3
----
1
2
3

query I nosort
SELECT a FROM t1 ORDER BY a LIMIT 2 OFFSET 2
----
3
4

query I nosort
SELECT a FROM t1 ORDER BY a DESC LIMIT 2
----
5
4

# ============================================================
# Combined projection + filter + order + limit
# ============================================================

query IR nosort
SELECT a, b FROM t1 WHERE a >= 2 ORDER BY b DESC LIMIT 3
----
5	50.500000
4	40.000000
3	30.500000

# ============================================================
# SELECT with NULL values
# ============================================================

statement ok
CREATE TABLE t3 (a INTEGER, b TEXT)

statement ok
INSERT INTO t3 VALUES (1, 'x'), (NULL, 'y'), (3, NULL)

query IT nosort
SELECT * FROM t3
----
1	x
NULL	y
3	NULL

query I nosort
SELECT a FROM t3
----
1
NULL
3

query T nosort
SELECT b FROM t3
----
x
y
NULL

# ============================================================
# SELECT * with WHERE
# ============================================================

query IT nosort
SELECT * FROM t3 WHERE a IS NOT NULL
----
1	x
3	NULL
