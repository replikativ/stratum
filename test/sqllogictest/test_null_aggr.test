# test_null_aggr.test
# PostgreSQL-compatible NULL handling in aggregate functions

# NULLs in aggregates â€” NULLs should be skipped
statement ok
CREATE TABLE nullints (i INTEGER)

statement ok
INSERT INTO nullints VALUES (1), (2), (NULL)

query I nosort
SELECT COUNT(*) FROM nullints
----
3

query I nosort
SELECT COUNT(i) FROM nullints
----
2

query R nosort
SELECT SUM(i) FROM nullints
----
3.000000

query R nosort
SELECT AVG(i) FROM nullints
----
1.500000

query I nosort
SELECT MIN(i) FROM nullints
----
1

query I nosort
SELECT MAX(i) FROM nullints
----
2

# Empty table aggregates
statement ok
CREATE TABLE empty_t (i INTEGER)

query I nosort
SELECT COUNT(*) FROM empty_t
----
0

query I nosort
SELECT COUNT(i) FROM empty_t
----
0

query R nosort
SELECT SUM(i) FROM empty_t
----
NULL

query R nosort
SELECT AVG(i) FROM empty_t
----
NULL

query R nosort
SELECT MIN(i) FROM empty_t
----
NULL

query R nosort
SELECT MAX(i) FROM empty_t
----
NULL
